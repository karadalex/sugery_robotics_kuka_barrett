L = zeros(1,7);
%d = [0.36, 0, 0.42, 0, 0.4, 0, 0];
%a = [0, -pi/2, pi/2, -pi/2, pi/2, -pi/2, pi/2];

%d = [0.157, 0.203, 0.204, 0.216, 0.184, 0.216, 0.8];
%a = [0, -pi/2, pi/2, pi/2, -pi/2, -pi/2, pi/2];

%d = [0.157, 0.203, 0.420, 0.184, 0.216, 0.8];
%a = [0, -pi/2, 0, -pi/2, -pi/2, pi/2];

d = [0.36, 0, 0.420, 0.4, 0, 0.8];
a = [0, -pi/2, pi, -pi/2, -pi/2, pi/2];

th = sym('th', [1, 6]);

[M, M_joints] = fwdKinSym(L(2:7), d, a);

M_0_4 = eye(4);
for i=1:3
    M_0_4 = M_0_4 * M_joints(:,:,i);
end
p = M_0_4 * M_joints(:,4,4);

R_4_7 = eye(4);
for i=4:6
    R_4_7 = R_4_7 * M_joints(:,:,i);
end
R_4_7 = R_4_7(1:3,1:3);

pa = simplify(expand(p(1)^2+(p(2))^2));